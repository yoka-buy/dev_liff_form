<!DOCTYPE html>
<html>
<head>
  <title>名前と年齢入力フォーム</title>
</head>
<body>
  <form id="myForm">
    <label for="name">名前:</label>
    <input type="text" list="names" id="name" name="name">
    <datalist id="names">
      <option value="山田太郎">
      <option value="鈴木次郎">
      <option value="佐藤花子">
    </datalist>
    <br><br>
    <label for="age">年齢:</label>
    <input type="number" id="age" name="age"><br><br>
    <button type="button" onclick="submitForm()">送信</button>
  </form>

  <div id="result"></div>

  <script>
    function submitForm() {
      // フォームデータを取得
      const formData = new FormData(document.getElementById('myForm'));

      // 入力された名前を取得
      const selectedName = formData.get('name');

      // datalistのoption要素を取得
      const options = document.getElementById('names').options;

      // 入力された名前がoption要素に含まれているかチェック
      let isValid = false;
      for (let i = 0; i < options.length; i++) {
        if (options[i].value === selectedName) {
          isValid = true;
          break;
        }
      }

      if (isValid) {
        // 入力値が有効な場合、残りの処理を実行
        const age = formData.get('age');
        // ... (以下、元の処理)
      } else {
        // 入力値が無効な場合、エラーメッセージを表示など
        alert('名前は選択肢から選んでください。');
        // 入力欄のフォーカスを戻すなど
        document.getElementById('name').focus();
      }
    }
  </script>
</body>
</html>
